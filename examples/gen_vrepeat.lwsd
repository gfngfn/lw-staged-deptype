let aux = rec(self : (q : Nat) -> ?(p : Nat) -> &(Vec %p) -> &(Vec %(p * q))) ->
  fun(m : Nat) -> fun?(n : Nat) -> fun(e : &(Vec %n)) ->
    if m <= 0 then
      &[| |]
    else
      &(~(gen_vconcat (n * (m - 1)) n) ~e ~(self (m - 1) e))
in
let gen_vrepeat =
  fun(n : Nat) -> fun(m : Nat) -> &(fun(v : Vec %n) -> ~(aux n m &v))
in
&(~(gen_vrepeat 3 5) [| 4; 6; 9 |])
