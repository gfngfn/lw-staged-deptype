let f =
  ~(
    let concat_and_add =
      fun (m : Int) -> fun (n : Int) ->
        &(fun (u1 : Vec %m) -> fun (u2 : Vec %n) -> fun (v : Vec %(add m n)) ->
          ~(gen_vadd (add n m)) (~(gen_vconcat m n) u1 u2) v
        )
    in
    concat_and_add 1 2
  )
in
f [| 3 |] [| 1; 4 |] [| 1; 5; 9 |]
